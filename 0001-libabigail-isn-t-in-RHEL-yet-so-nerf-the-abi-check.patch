From 78bda9cefdb5e29cedd379c1b9ea9fd8274d7c5d Mon Sep 17 00:00:00 2001
From: Peter Jones <pjones@redhat.com>
Date: Mon, 13 Mar 2017 13:05:58 -0400
Subject: [PATCH 1/3] libabigail isn't in RHEL yet, so nerf the abi check.

Signed-off-by: Peter Jones <pjones@redhat.com>
---
 Make.rules   | 9 ---------
 Makefile     | 6 +++---
 src/Makefile | 5 -----
 3 files changed, 3 insertions(+), 17 deletions(-)

diff --git a/Make.rules b/Make.rules
index 88b9aa7..a7d6a23 100644
--- a/Make.rules
+++ b/Make.rules
@@ -22,15 +22,6 @@ include $(TOPDIR)/Make.version
 	  -Wl,--version-script=$(MAP) \
 	  -o $@ $^ $(LDLIBS)
 
-%.abixml : %.so
-	$(ABIDW) --headers-dir $(TOPDIR)/src/include/efivar/ --out-file $@ $^
-
-%.abicheck : %.so
-	$(ABIDIFF) --suppr \
-		$(patsubst %.so,%.abignore,$<) \
-		$(patsubst %.so,%.abixml,$<) \
-		$<
-
 %.o : %.c
 	$(CC) $(cflags) -fPIC $(CPPFLAGS) -c -o $@ $(filter %.c %.o %.S,$^)
 
diff --git a/Makefile b/Makefile
index 4d6d308..504a747 100644
--- a/Makefile
+++ b/Makefile
@@ -17,7 +17,7 @@ install :
 		$(MAKE) -C $$x $@ ; \
 	done
 
-abidw abicheck efivar efivar-static static:
+efivar efivar-static static:
 	$(MAKE) -C src $@
 
 $(SUBDIRS) :
@@ -44,7 +44,7 @@ clean :
 
 GITTAG = $(VERSION)
 
-test-archive: abicheck efivar.spec
+test-archive: efivar.spec
 	@rm -rf /tmp/efivar-$(VERSION) /tmp/efivar-$(VERSION)-tmp
 	@mkdir -p /tmp/efivar-$(VERSION)-tmp
 	@git archive --format=tar $(shell git branch | awk '/^*/ { print $$2 }') | ( cd /tmp/efivar-$(VERSION)-tmp/ ; tar x )
@@ -58,7 +58,7 @@ test-archive: abicheck efivar.spec
 tag:
 	git tag -s $(GITTAG) refs/heads/master
 
-archive: abicheck abidw tag efivar.spec
+archive: tag efivar.spec
 	@rm -rf /tmp/efivar-$(VERSION) /tmp/efivar-$(VERSION)-tmp
 	@mkdir -p /tmp/efivar-$(VERSION)-tmp
 	@git archive --format=tar $(GITTAG) | ( cd /tmp/efivar-$(VERSION)-tmp/ ; tar x )
diff --git a/src/Makefile b/src/Makefile
index 0c16597..a5d98ec 100644
--- a/src/Makefile
+++ b/src/Makefile
@@ -32,11 +32,6 @@ all : $(TARGETS)
 
 static : $(STATICTARGETS)
 
-abidw : $(patsubst %.so,%.abixml,$(LIBTARGETS))
-	git commit -m "Update .abixml files" -s $^
-
-abicheck : $(patsubst %.so,%.abicheck,$(LIBTARGETS))
-
 ./guid-symbols.c : include/efivar/efivar-guids.h
 ./guids.bin : include/efivar/efivar-guids.h
 ./names.bin : include/efivar/efivar-guids.h
-- 
2.9.3

